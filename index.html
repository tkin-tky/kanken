<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" />
  <title>å››å­—ç†Ÿèªã‚’ç­”ãˆã‚ˆã†ï¼</title>
  <style>
    :root{
      --W:1200;
      --H:2400;
      --paper1:#f4efe6;
      --paper2:#efe7d8;
      --ink:rgba(10,10,14,0.92);
      --muted:rgba(10,10,14,0.60);
      --panel:rgba(255,255,255,0.76);
      --border:rgba(0,0,0,0.10);
      --good:#06d6a0;
      --bad:#ff4d6d;
      --safeT: env(safe-area-inset-top);
      --safeR: env(safe-area-inset-right);
      --safeB: env(safe-area-inset-bottom);
      --safeL: env(safe-area-inset-left);
    }
    *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    html,body{
      width:100%; height:100%;
      margin:0;
      background: linear-gradient(135deg,var(--paper1),var(--paper2));
      color:var(--ink);
      font-family: system-ui,-apple-system,"Hiragino Sans","Noto Sans JP","Yu Gothic","Meiryo",sans-serif;
      overflow:hidden; /* 1ç”»é¢å›ºå®š */
    }

    /* ã‚‚ã—JSãŒè½ã¡ã¦ã‚‚ä½•ã‹è¦‹ãˆã‚‹ã‚ˆã†ã«æœ€ä½é™ã®èƒŒæ™¯ */
    body::before{
      content:"";
      position:fixed; inset:0;
      background:
        radial-gradient(900px 900px at 20% 25%, rgba(0,0,0,0.08), transparent 60%),
        radial-gradient(700px 700px at 85% 75%, rgba(0,0,0,0.06), transparent 62%);
      pointer-events:none;
    }

    /* === ã‚¹ãƒ†ãƒ¼ã‚¸æ ï¼ˆç”»é¢ã«åã‚ã‚‹ï¼‰ === */
    #wrap{
      position:fixed; inset:0;
      display:grid;
      place-items:center;
      padding: calc(10px + var(--safeT)) calc(10px + var(--safeR)) calc(10px + var(--safeB)) calc(10px + var(--safeL));
    }
    #stage{
      width: calc(var(--W) * 1px);
      height: calc(var(--H) * 1px);
      transform-origin: top left;
      transform: scale(0.33); /* â˜…çœŸã£ç™½å›é¿ã®ä¿é™º */
      border-radius: 48px;
      overflow:hidden;
      position:relative;
      box-shadow: 0 30px 80px rgba(0,0,0,0.25);

      background:
        url('back.jpg') center / cover no-repeat,
        radial-gradient(220px 220px at 86% 16%, rgba(255,77,109,0.12), transparent 62%),
        radial-gradient(900px 900px at 18% 28%, rgba(10,10,14,0.10), transparent 60%),
        linear-gradient(0deg, rgba(0,0,0,0.04) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,0,0,0.04) 1px, transparent 1px);
      background-size: cover, auto, auto, 64px 64px, 64px 64px;
      background-position: center, center, center, 0 0, 0 0;
    }
    #stage::before{
      content:"æ¼¢\nå­—\néŠ\næˆ¯";
      white-space:pre;
      position:absolute; inset:0;
      display:grid; place-items:center;
      font-weight:900;
      font-size:260px;
      line-height:1.05;
      letter-spacing:0.14em;
      color: rgba(10,10,14,0.08);
      transform: rotate(-8deg);
      pointer-events:none;
    }

    .pad{ padding:56px; position:relative; z-index:1; }

    .topbar{
      display:flex; justify-content:space-between; gap:24px;
      align-items:flex-start;
      margin-bottom: 28px;
    }
    h1{
      margin:0;
      font-size:54px;
      letter-spacing:0.06em;
      line-height:1.1;
    }
    .sub{ font-size:28px; color:var(--muted); margin-top:10px; }

    .stats{ display:flex; gap:18px; }
    .pill{
      min-width:220px;
      background: rgba(255,255,255,0.78);
      border:1px solid var(--border);
      border-radius:26px;
      padding:18px 20px;
      box-shadow: 0 12px 26px rgba(0,0,0,0.10);
    }
    .pill .k{ font-size:22px; color:var(--muted); }
    .pill .v{ font-size:40px; font-weight:900; }

    .panel{
      background: var(--panel);
      border:1px solid var(--border);
      border-radius: 36px;
      padding: 36px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.08);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    .controls{
      display:flex; gap:18px; align-items:center; flex-wrap:wrap;
    }
    .label{
      display:flex; flex-direction:column; gap:10px;
    }
    .label span{ font-size:22px; color:var(--muted); letter-spacing:.04em; }

    .select{
      appearance:none;
      border:1px solid rgba(0,0,0,0.12);
      background: rgba(255,255,255,0.70);
      color: var(--ink);
      border-radius:24px;
      padding:16px 18px;
      font-size:28px;
      min-width: 320px;
      outline:none;
      box-shadow: 0 10px 22px rgba(0,0,0,0.08);
    }

    .btn{
      border:1px solid rgba(0,0,0,0.10);
      background: rgba(255,255,255,0.65);
      color: var(--ink);
      border-radius:28px;
      padding:18px 22px;
      font-size:30px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      box-shadow: 0 12px 26px rgba(0,0,0,0.10);
      touch-action: manipulation;
    }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      background: linear-gradient(135deg, rgba(58,134,255,0.26), rgba(46,196,182,0.18));
      border-color: rgba(58,134,255,0.28);
    }
    .btn.warn{
      background: linear-gradient(135deg, rgba(255,77,109,0.22), rgba(131,56,236,0.16));
      border-color: rgba(255,77,109,0.28);
    }
    .btn.good{
      background: linear-gradient(135deg, rgba(6,214,160,0.26), rgba(255,166,43,0.16));
      border-color: rgba(6,214,160,0.30);
    }

    .qarea{
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 28px;
      margin-top: 24px;
    }

    .question-box{ display:flex; flex-direction:column; gap:26px; min-height:980px; }

    .qmeta{ display:flex; justify-content:space-between; align-items:center; gap:18px; }
    .qtitle{ font-size:34px; font-weight:900; letter-spacing:.04em; }
    .qdesc{ font-size:26px; color:var(--muted); margin-top:8px; }
    .timer{ text-align:right; }
    .time{ font-size:56px; font-weight:950; letter-spacing:.04em; }
    .hint{ font-size:22px; color:var(--muted); margin-top:10px; }

    .idiom{
      display:flex; justify-content:center; align-items:center;
      gap:22px;
      margin-top: 20px;
      padding: 34px 20px;
      border-radius: 34px;
      background: rgba(255,255,255,0.55);
      border:1px solid rgba(0,0,0,0.08);
    }
    .cell{
      width:170px; height:170px;
      display:grid; place-items:center;
      border-radius:26px;
      font-size:92px;
      font-weight:950;
      background: rgba(255,255,255,0.82);
      border:1px solid rgba(0,0,0,0.10);
      box-shadow: 0 10px 22px rgba(0,0,0,0.10);
    }
    .blank{
      background: rgba(58,134,255,0.12);
      border:2px dashed rgba(58,134,255,0.55);
      color: rgba(10,10,14,0.45);
    }

    .choices{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
      margin-top: 18px;
    }
    .choice{
      height:160px;
      border-radius:34px;
      font-size:72px;
      font-weight:950;
      background: rgba(255,255,255,0.78);
      border:1px solid rgba(0,0,0,0.10);
      cursor:pointer;
      user-select:none;
      display:grid;
      place-items:center;
      box-shadow: 0 12px 26px rgba(0,0,0,0.10);
      position:relative;
      overflow:hidden;
      touch-action: manipulation;
    }
    .choice:active{ transform: translateY(2px); }
    .choice.good{ outline: 4px solid rgba(6,214,160,0.40); }
    .choice.bad{ outline: 4px solid rgba(255,77,109,0.36); }

    .feedback{
      margin-top: 14px;
      min-height:72px;
      display:flex; align-items:center; justify-content:center;
      font-size:34px; font-weight:950;
      letter-spacing:.04em;
      color: var(--muted);
    }

    .side{ display:flex; flex-direction:column; gap:24px; min-height:980px; }

    .progress{ display:flex; gap:10px; flex-wrap:wrap; padding-top:8px; }
    .dot{
      width:46px; height:46px;
      border-radius:18px;
      border:1px solid rgba(0,0,0,0.12);
      background: rgba(255,255,255,0.70);
      display:grid; place-items:center;
      font-size:22px;
      color: rgba(10,10,14,0.55);
      box-shadow: 0 8px 16px rgba(0,0,0,0.08);
    }
    .dot.done{ background: rgba(6,214,160,0.22); border-color: rgba(6,214,160,0.32); }
    .dot.bad{ background: rgba(255,77,109,0.20); border-color: rgba(255,77,109,0.30); }
    .dot.now{ background: rgba(58,134,255,0.22); border-color: rgba(58,134,255,0.32); color: rgba(10,10,14,0.82); }

    .log{
      background: rgba(255,255,255,0.72);
      border:1px solid rgba(0,0,0,0.10);
      border-radius: 28px;
      padding: 22px;
      min-height: 520px;
      box-shadow: 0 16px 34px rgba(0,0,0,0.08);
      overflow:hidden;
    }
    .log h3{ margin:0 0 12px 0; font-size:28px; letter-spacing:.03em; }
    .line{
      font-size:24px;
      color: rgba(10,10,14,0.62);
      line-height:1.55;
      padding: 6px 0;
      border-bottom:1px dashed rgba(0,0,0,0.10);
    }
    .line:last-child{ border-bottom:none; }

    .footer{
      position:absolute;
      left:56px; right:56px;
      bottom:44px;
      display:flex; justify-content:space-between; gap:20px;
      color: rgba(10,10,14,0.55);
      font-size:22px;
    }

    /* ===== çµæœã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ ===== */
    #overlay{
      position:absolute; inset:0;
      display:none;
      background: rgba(0,0,0,0.45);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      align-items:center; justify-content:center;
      padding: 56px;
      z-index: 10;
    }
    #overlay .card{
      width:100%;
      max-width: 980px;
      border-radius:44px;
      background: rgba(255,255,255,0.88);
      border:1px solid rgba(0,0,0,0.10);
      padding:44px;
      box-shadow: 0 40px 100px rgba(0,0,0,0.35);
      white-space: pre-line;
    }
    #overlay h2{
      margin:0 0 10px 0;
      font-size:54px;
      letter-spacing:0.05em;
    }
    #praiseLabel{
      margin: 10px 0 22px 0;
      font-size:60px;
      font-weight:950;
      letter-spacing:0.04em;
      line-height:1.15;
    }
    #praiseLabel::after{
      content:"";
      display:block;
      margin-top:14px;
      height:10px;
      width:52%;
      border-radius:999px;
      background: linear-gradient(90deg, rgba(255,77,109,0.55), rgba(255,166,43,0.35), rgba(46,196,182,0.30));
    }
    .resultBig{
      font-size:44px;
      font-weight:950;
      margin: 10px 0 8px 0;
      letter-spacing:0.03em;
    }
    .small{
      color: rgba(10,10,14,0.62);
      font-size:26px;
      line-height:1.6;
      white-space: pre-line;
    }
    .actions{
      margin-top:28px;
      display:flex; gap:16px; flex-wrap:wrap;
    }

    /* ===== â€œçœŸã£ç™½â€æ™‚ã«åŸå› ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã‚¨ãƒ©ãƒ¼ãƒãƒŠãƒ¼ ===== */
    #errBar{
      position:absolute;
      left: 26px;
      right: 26px;
      top: 26px;
      z-index: 999;
      display:none;
      background: rgba(255,255,255,0.92);
      border: 2px solid rgba(255,77,109,0.35);
      border-radius: 22px;
      padding: 14px 16px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.18);
      font-size: 22px;
      line-height: 1.35;
      color: rgba(10,10,14,0.85);
    }
    #errBar b{ color: rgba(255,77,109,0.92); }
  </style>
</head>

<body>
  <div id="wrap">
    <div id="stage" aria-label="å››å­—ç†Ÿèªã‚²ãƒ¼ãƒ ã‚¹ãƒ†ãƒ¼ã‚¸">
      <div id="errBar"></div>

      <div class="pad">
        <div class="topbar">
          <div>
            <h1>å››å­—ç†Ÿèªã‚’ç­”ãˆã‚ˆã†ï¼</h1>
            <div class="sub">ä¸€å­—ç©´åŸ‹ã‚ï¼ˆ10å•ï¼‰ãƒ»ã‚¹ãƒãƒ›1ç”»é¢</div>
          </div>
          <div class="stats">
            <div class="pill">
              <div class="k">å•é¡Œ</div>
              <div class="v"><span id="qIndex">1</span> / 10</div>
            </div>
            <div class="pill">
              <div class="k">ãƒ¬ãƒ™ãƒ«ï¼ˆæ¼¢æ¤œç›®å®‰ï¼‰</div>
              <div class="v">Lv.<span id="lvlLabel">1</span></div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="controls">
            <div class="label">
              <span>é›£æ˜“åº¦ã‚’é¸æŠ</span>
              <select id="levelSelect" class="select" aria-label="ãƒ¬ãƒ™ãƒ«é¸æŠ">
                <option value="1">ãƒ¬ãƒ™ãƒ«1ï¼ˆæ¼¢æ¤œ10ç´šç›¸å½“ï¼‰</option>
                <option value="2">ãƒ¬ãƒ™ãƒ«2ï¼ˆæ¼¢æ¤œ9ç´šç›¸å½“ï¼‰</option>
                <option value="3">ãƒ¬ãƒ™ãƒ«3ï¼ˆæ¼¢æ¤œ8ç´šç›¸å½“ï¼‰</option>
                <option value="4">ãƒ¬ãƒ™ãƒ«4ï¼ˆæ¼¢æ¤œ7ç´šç›¸å½“ï¼‰</option>
                <option value="5">ãƒ¬ãƒ™ãƒ«5ï¼ˆæ¼¢æ¤œ6ç´šç›¸å½“ï¼‰</option>
                <option value="6">ãƒ¬ãƒ™ãƒ«6ï¼ˆæ¼¢æ¤œ5ç´šç›¸å½“ï¼‰</option>
                <option value="7">ãƒ¬ãƒ™ãƒ«7ï¼ˆæ¼¢æ¤œ4ç´šç›¸å½“ï¼‰</option>
                <option value="8">ãƒ¬ãƒ™ãƒ«8ï¼ˆæ¼¢æ¤œ3ç´šç›¸å½“ï¼‰</option>
                <option value="9">ãƒ¬ãƒ™ãƒ«9ï¼ˆæ¼¢æ¤œæº–2ã€œ2ç´šç›¸å½“ï¼‰</option>
                <option value="10">ãƒ¬ãƒ™ãƒ«10ï¼ˆæ¼¢æ¤œæº–1ã€œ1ç´šç›¸å½“ï¼‰</option>
              </select>
            </div>

            <button id="startBtn" class="btn primary">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
            <button id="pauseBtn" class="btn warn" disabled>â¸ ä¸€æ™‚åœæ­¢</button>
            <button id="restartBtn" class="btn" disabled>ğŸ” ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ</button>

            <div style="flex:1"></div>

            <div style="display:flex;flex-direction:column;gap:10px;align-items:flex-end;">
              <div style="font-size:22px;color:var(--muted);letter-spacing:.04em;">è¨ˆæ¸¬ï¼ˆå•é¡Œè¡¨ç¤ºâ†’å›ç­”ã¾ã§ï¼‰</div>
              <div style="font-size:26px;color:var(--muted);">â€»ä¸€æ™‚åœæ­¢ä¸­ã¯ã‚«ã‚¦ãƒ³ãƒˆã—ã¾ã›ã‚“</div>
            </div>
          </div>

          <div class="qarea">
            <div class="question-box panel" style="padding:32px;">
              <div class="qmeta">
                <div>
                  <div class="qtitle">ç©ºç™½ï¼ˆâ–¡ï¼‰ã«å…¥ã‚‹æ¼¢å­—ã‚’é¸ã‚“ã§ãã ã•ã„</div>
                  <div class="qdesc">é¸æŠè‚¢ã¯4ã¤ã€‚ã‚¿ãƒƒãƒ—ã§å›ç­”ã€‚</div>
                </div>
                <div class="timer">
                  <div class="time" id="timeLabel">0.000s</div>
                  <div class="hint" id="timeHint">ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ã§è¨ˆæ¸¬é–‹å§‹</div>
                </div>
              </div>

              <div class="idiom" aria-label="å››å­—ç†Ÿèª">
                <div class="cell" id="c0">?</div>
                <div class="cell" id="c1">?</div>
                <div class="cell" id="c2">?</div>
                <div class="cell blank" id="c3">â–¡</div>
              </div>

              <div class="choices" aria-label="é¸æŠè‚¢">
                <button class="choice" id="ch0" disabled>?</button>
                <button class="choice" id="ch1" disabled>?</button>
                <button class="choice" id="ch2" disabled>?</button>
                <button class="choice" id="ch3" disabled>?</button>
              </div>

              <div class="feedback" id="feedback">â€”</div>
            </div>

            <div class="side">
              <div class="panel" style="padding:32px;">
                <div style="display:flex; justify-content:space-between; align-items:center; gap: 14px;">
                  <div style="font-size:30px; font-weight:950; letter-spacing:.03em;">é€²æ—</div>
                  <div style="font-size:22px; color:var(--muted);" id="statusLabel">å¾…æ©Ÿä¸­</div>
                </div>
                <div class="progress" id="progress"></div>
              </div>

              <div class="log">
                <h3>è¨˜éŒ²ï¼ˆç›´è¿‘ï¼‰</h3>
                <div id="logLines"></div>
              </div>

              <div class="panel" style="padding:32px;">
                <div style="font-size:28px; font-weight:950; letter-spacing:.03em; margin-bottom:10px;">æ“ä½œ</div>
                <div style="font-size:24px; color:var(--muted); line-height:1.6;">
                  ãƒ»ã€Œä¸€æ™‚åœæ­¢ã€ã‚’ã‚¿ãƒƒãƒ—ã§åœæ­¢ï¼å†é–‹<br/>
                  ãƒ»å›ç­”ã™ã‚‹ã¨æ¬¡ã®å•é¡Œã¸è‡ªå‹•é€²è¡Œ<br/>
                  ãƒ»å…¨10å•ã®å¹³å‡å›ç­”æ™‚é–“ã‚’æœ€å¾Œã«è¡¨ç¤º
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="footer">
          <div>Â© Kanji Idiom Quiz ãƒ» 1200Ã—2400 å›ºå®šUI</div>
          <div>ãƒ’ãƒ³ãƒˆï¼šãƒ¬ãƒ™ãƒ«ã‚’å¤‰ãˆã‚‹ã¨å‡ºé¡Œèªå½™ãŒå¤‰ã‚ã‚Šã¾ã™</div>
        </div>
      </div>

      <div id="overlay">
        <div class="card">
          <h2>ã‚²ãƒ¼ãƒ å®Œäº†</h2>
          <div id="praiseLabel">â€”</div>

          <div class="resultBig">å¹³å‡ï¼š<span id="avgLabel">0.000s</span></div>
          <div class="resultBig">æ­£ç­”æ•°ï¼š<span id="scoreLabel">0</span> / 10</div>

          <div class="small" id="detailLabel"></div>
          <div class="actions">
            <button class="btn good" id="playAgainBtn">ã‚‚ã†ä¸€åº¦ï¼ˆåŒãƒ¬ãƒ™ãƒ«ï¼‰</button>
            <button class="btn" id="closeOverlayBtn">é–‰ã˜ã‚‹</button>
          </div>
        </div>
      </div>

    </div>
  </div>

<script>
(function(){
  /* ========= â€œçœŸã£ç™½â€åŸå› ã‚’è¦‹ãˆã‚‹åŒ–ï¼ˆiPhoneã§ã‚‚å‡ºã‚‹ï¼‰ ========= */
  var errBar = document.getElementById('errBar');
  function showErr(msg){
    try{
      errBar.style.display = "block";
      errBar.innerHTML = "<b>ã‚¨ãƒ©ãƒ¼:</b> " + String(msg).replace(/</g,"&lt;").replace(/>/g,"&gt;");
    }catch(e){}
  }
  window.addEventListener("error", function(e){
    showErr((e && e.message) ? e.message : "unknown error");
  });
  window.addEventListener("unhandledrejection", function(e){
    showErr((e && e.reason) ? e.reason : "unhandled rejection");
  });

  /* ========= 1200x2400 ã‚’å¿…ãšç”»é¢å†…ã«ãƒ•ã‚£ãƒƒãƒˆ ========= */
  var stage = document.getElementById('stage');
  function fitStage(){
    var W = 1200, H = 2400;
    var vw = Math.max(1, document.documentElement.clientWidth || 0, window.innerWidth || 0);
    var vh = Math.max(1, document.documentElement.clientHeight || 0, window.innerHeight || 0);
    var s = Math.min(vw / W, vh / H);
    if(!isFinite(s) || s <= 0.05) s = 0.33; // ä¿é™º
    stage.style.transform = "scale(" + s + ")";
  }
  function fitStageRetry(){
    fitStage();
    requestAnimationFrame(fitStage);
    setTimeout(fitStage, 50);
    setTimeout(fitStage, 200);
    setTimeout(fitStage, 600);
  }
  window.addEventListener('resize', fitStageRetry, {passive:true});
  window.addEventListener('orientationchange', fitStageRetry, {passive:true});
  fitStageRetry();

  /* ========= ã‚²ãƒ¼ãƒ æœ¬ä½“ï¼ˆES6æ©Ÿèƒ½ã‚’é¿ã‘ã¦å®‰å®šåŒ–ï¼‰ ========= */

  // å‡ºé¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆå„ãƒ¬ãƒ™ãƒ«30å€‹ï¼‰
  var idiomsByLevel = {
    1: [
      "ä¸€çŸ³äºŒé³¥","å¤§åŒå°ç•°","å‰å¾Œå·¦å³","æ—©èµ·æ—©å¯","å³å¾€å·¦å¾€","å±±å·è‰æœ¨","ç”·å¥³å¹³ç­‰","èŠ±é³¥é¢¨æœˆ","ç™½é»’æ˜ç™½","åƒå®¢ä¸‡æ¥",
      "æ±è¥¿å—åŒ—","æ˜æœ—å¿«æ´»","å®‰å…¨ç¬¬ä¸€","è‡ªç”»è‡ªè³›","å…ƒæ°—æºŒå‰Œ","ä¸€é•·ä¸€çŸ­","åä¸­å…«ä¹","åƒå¤‰ä¸‡åŒ–","æ—¥ã€…æ˜¯å¥½æ—¥","ä¸€å¿ƒåŒä½“",
      "ä¸€ç”Ÿæ‡¸å‘½","å…ˆæ‰‹å¿…å‹","æ¸©åšç¯¤å®Ÿ","ç™¾ç™ºç™¾ä¸­","ä¸€æ—¥ä¸€å–„","ç¬‘é–€æ¥ç¦","å¤©çœŸçˆ›æ¼«","æœ‰åç„¡å®Ÿ","å¿ƒèº«ä¸€å¦‚","ä¸€æ—¥åƒç§‹"
    ],
    2: [
      "ç•°å£åŒéŸ³","è‡ªæ¥­è‡ªå¾—","åäººåè‰²","æ¸©æ•…çŸ¥æ–°","ä»¥å¿ƒä¼å¿ƒ","èµ·æ­»å›ç”Ÿ","æ™´è€•é›¨èª­","è‡¨æ©Ÿå¿œå¤‰","è©¦è¡ŒéŒ¯èª¤","å› æœå¿œå ±",
      "æ‚ªæˆ¦è‹¦é—˜","å±æ©Ÿä¸€é«ª","å››é¢æ¥šæ­Œ","ä¸€é€²ä¸€é€€","å¿ƒæ©Ÿä¸€è»¢","æœ‰è¨€å®Ÿè¡Œ","å„ªæŸ”ä¸æ–­","è‡ªçµ¦è‡ªè¶³","ä¸ƒè»¢å…«èµ·","ä¸€å¿µç™ºèµ·",
      "é›»å…‰çŸ³ç«","äº”é‡Œéœ§ä¸­","åƒå·®ä¸‡åˆ¥","è³ªå®Ÿå‰›å¥","ä¸€æ”«åƒé‡‘","æ˜é¡æ­¢æ°´","æ „æ¯ç››è¡°","æ—¥é€²æœˆæ­©","åˆ‡ç£‹ç¢ç£¨","æœä»¤æš®æ”¹"
    ],
    3: [
      "ç™¾èŠ±ç¹šä¹±","åƒè¼‰ä¸€é‡","å‰ä»£æœªè","ç´†ä½™æ›²æŠ˜","ä¸€ç¶²æ‰“å°½","ç–‘å¿ƒæš—é¬¼","ç™¾æˆ¦éŒ¬ç£¨","ç¸¦æ¨ªç„¡å°½","æ³°ç„¶è‡ªè‹¥","å‹§å–„æ‡²æ‚ª",
      "æ„å‘³æ·±é•·","çµ‚å§‹ä¸€è²«","è¡¨è£ä¸€ä½“","ç©ºå‰çµ¶å¾Œ","ä¸€å–œä¸€æ†‚","è‡ªç¸„è‡ªç¸›","é‡å°æ£’å¤§","ä»˜å’Œé›·åŒ","å„ªå‹åŠ£æ•—","å› å¾ªå§‘æ¯",
      "ç„¡ç‚ºå¾’é£Ÿ","é–€å¤–ä¸å‡º","ç–¾é¢¨è¿…é›·","èé€šç„¡ç¢","ç²¾åŠ±æªå‹¤","å·§è¨€ä»¤è‰²","è‡¥è–ªå˜—èƒ†","æ²åœŸé‡æ¥","ä¸€ç€‰åƒé‡Œ","ç²‰éª¨ç •èº«"
    ],
    4: [
      "æ¯€èª‰è¤’è²¶","æ…‡æ‡ƒç„¡ç¤¼","æ”¯é›¢æ»…è£‚","æ›–æ˜§æ¨¡ç³Š","è·‹æ‰ˆè·³æ¢","æ¬£å–œé›€èº","è¡†å¯¡æ•µã›ãš","ç¢ºä¹ä¸æŠœ","éš”é´æ»ç—’","ç©ºç†ç©ºè«–",
      "ç‰çŸ³æ··äº¤","ä¸€æœä¸€å¤•","ä½™è£•ç¶½ã€…","ä¹¾å¤ä¸€æ“²","çµ‚æ—¥ä¸€èª ","ä¸€éƒ¨å§‹çµ‚","åŒåºŠç•°å¤¢","å…¬æ˜æ­£å¤§","è»½æŒ™å¦„å‹•","å¤šå²äº¡ç¾Š",
      "ä¸€å¯¸å…‰é™°","ç ´é¡”ä¸€ç¬‘","ä¹æ­»ä¸€ç”Ÿ","åƒæ€ä¸‡è€ƒ","æƒ…çŠ¶é…Œé‡","æ˜å“²ä¿èº«","å¤–æŸ”å†…å‰›","æè‘‰æœ«ç¯€","å‰›æ¯…æœ¨è¨¥","è™šå¿ƒå¦æ‡"
    ],
    5: [
      "æ”¹éè‡ªæ–°","æœä¸‰æš®å››","å¤§å™¨æ™©æˆ","ä¸€ç½°ç™¾æˆ’","ä¸è¨€å®Ÿè¡Œ","ç‡å…ˆå‚ç¯„","ä¸€é¨å½“åƒ","åƒè»ä¸‡é¦¬","ä¸€åˆ€ä¸¡æ–­","ç™¾æŠ˜ä¸æ’“",
      "ç‰çŸ³æ··äº¤","å…¬æ˜æ­£å¤§","æ¸©æ•…çŸ¥æ–°","è‡¨æ©Ÿå¿œå¤‰","è©¦è¡ŒéŒ¯èª¤","å› æœå¿œå ±","æ˜é¡æ­¢æ°´","åˆ‡ç£‹ç¢ç£¨","æ „æ¯ç››è¡°","æ—¥é€²æœˆæ­©",
      "ç™¾èŠ±ç¹šä¹±","åƒè¼‰ä¸€é‡","å‰ä»£æœªè","ç´†ä½™æ›²æŠ˜","ä¸€ç¶²æ‰“å°½","ç™¾æˆ¦éŒ¬ç£¨","ç–‘å¿ƒæš—é¬¼","è‡ªç¸„è‡ªç¸›","ä»˜å’Œé›·åŒ","é‡å°æ£’å¤§"
    ],
    6: [
      "å‰›æ¯…æœ¨è¨¥","è™šå¿ƒå¦æ‡","ç‹¬ç«‹ç‹¬æ­©","å¹³èº«ä½é ­","æ­£ã€…å ‚ã€…","ç²¾é€²æ½”æ–","æ¸©åšç¯¤å®Ÿ","æ³°ç„¶è‡ªè‹¥","æ˜é¡æ­¢æ°´","å‹§å–„æ‡²æ‚ª",
      "åˆ‡ç£‹ç¢ç£¨","æ „æ¯ç››è¡°","æ—¥é€²æœˆæ­©","ç¸¦æ¨ªç„¡å°½","ç™¾æˆ¦éŒ¬ç£¨","è‡¥è–ªå˜—èƒ†","æ²åœŸé‡æ¥","å› å¾ªå§‘æ¯","ç„¡ç‚ºå¾’é£Ÿ","é–€å¤–ä¸å‡º",
      "ç–¾é¢¨è¿…é›·","èé€šç„¡ç¢","ç²¾åŠ±æªå‹¤","ä¸€ç€‰åƒé‡Œ","ä¹¾å¤ä¸€æ“²","ç¢ºä¹ä¸æŠœ","éš”é´æ»ç—’","ç©ºç†ç©ºè«–","ä¹æ­»ä¸€ç”Ÿ","ç²‰éª¨ç •èº«"
    ],
    7: [
      "å‰£å‘‘æµ®èº","éŸ‹ç·¨ä¸‰çµ¶","å­¤è»å¥®é—˜","å½“æ„å³å¦™","èé€šç„¡ç¢","ä¹¾å¤ä¸€æ“²","ç²‰éª¨ç •èº«","ä¹æ­»ä¸€ç”Ÿ","æƒ…çŠ¶é…Œé‡","æè‘‰æœ«ç¯€",
      "ç‰çŸ³æ··äº¤","åŒåºŠç•°å¤¢","è»½æŒ™å¦„å‹•","å¤šå²äº¡ç¾Š","å¤–æŸ”å†…å‰›","æ˜å“²ä¿èº«","ä¸€å¯¸å…‰é™°","çµ‚æ—¥ä¸€èª ","ä½™è£•ç¶½ã€…","ç ´é¡”ä¸€ç¬‘",
      "ç¢ºä¹ä¸æŠœ","éš”é´æ»ç—’","ç©ºç†ç©ºè«–","è¡†å¯¡æ•µã›ãš","æ…‡æ‡ƒç„¡ç¤¼","æ¬£å–œé›€èº","è·‹æ‰ˆè·³æ¢","æ›–æ˜§æ¨¡ç³Š","æ¯€èª‰è¤’è²¶","æ”¯é›¢æ»…è£‚"
    ],
    8: [
      "é¶å£ç‰›å¾Œ","å·§è¨€ä»¤è‰²","å­Ÿæ¯ä¸‰é·","ç•°ç«¯é‚ªèª¬","ç™¾æŠ˜ä¸æ’“","ä¸€æ„å°‚å¿ƒ","ç‹¬ç«‹ç‹¬æ­©","è™šå¿ƒå¦æ‡","å‰›æ¯…æœ¨è¨¥","å¹³èº«ä½é ­",
      "æ­£ã€…å ‚ã€…","ç²¾é€²æ½”æ–","æ³°ç„¶è‡ªè‹¥","æ˜é¡æ­¢æ°´","åˆ‡ç£‹ç¢ç£¨","æ „æ¯ç››è¡°","æ—¥é€²æœˆæ­©","ç¸¦æ¨ªç„¡å°½","ç™¾æˆ¦éŒ¬ç£¨","è‡¥è–ªå˜—èƒ†",
      "æ²åœŸé‡æ¥","è‡ªç¸„è‡ªç¸›","ä»˜å’Œé›·åŒ","é‡å°æ£’å¤§","å› å¾ªå§‘æ¯","ç„¡ç‚ºå¾’é£Ÿ","é–€å¤–ä¸å‡º","ç–¾é¢¨è¿…é›·","èé€šç„¡ç¢","ä¸€ç€‰åƒé‡Œ"
    ],
    9: [
      "åˆ®ç›®ç›¸å¾…","ä¸€è¦–åŒä»","å¤©ä¸‹ç„¡åŒ","è±ªæ”¾ç£Šè½","è¡æ˜å¡æ™º","æ…§çœ¼è­˜è¦‹","ç™¾æˆ¦éŒ¬ç£¨","ç¸¦æ¨ªç„¡å°½","æ˜é¡æ­¢æ°´","æ³°ç„¶è‡ªè‹¥",
      "åˆ‡ç£‹ç¢ç£¨","æ „æ¯ç››è¡°","æ—¥é€²æœˆæ­©","ç™¾èŠ±ç¹šä¹±","åƒè¼‰ä¸€é‡","å‰ä»£æœªè","ç´†ä½™æ›²æŠ˜","ä¸€ç¶²æ‰“å°½","è‡ªç¸„è‡ªç¸›","ä»˜å’Œé›·åŒ",
      "é‡å°æ£’å¤§","å› å¾ªå§‘æ¯","ç„¡ç‚ºå¾’é£Ÿ","é–€å¤–ä¸å‡º","ç–¾é¢¨è¿…é›·","èé€šç„¡ç¢","ç²¾åŠ±æªå‹¤","ä¹¾å¤ä¸€æ“²","ç¢ºä¹ä¸æŠœ","ç©ºç†ç©ºè«–"
    ],
    10:[
      "æ¬£å–œé›€èº","æ›–æ˜§æ¨¡ç³Š","è¡†å¯¡æ•µã›ãš","æ…‡æ‡ƒç„¡ç¤¼","æ²åœŸé‡æ¥","è·‹æ‰ˆè·³æ¢","æ¯€èª‰è¤’è²¶","æ”¯é›¢æ»…è£‚","ç¢ºä¹ä¸æŠœ","éš”é´æ»ç—’",
      "ä¹¾å¤ä¸€æ“²","å¤šå²äº¡ç¾Š","éŸ‹ç·¨ä¸‰çµ¶","å‰£å‘‘æµ®èº","è¡æ˜å¡æ™º","æ…§çœ¼è­˜è¦‹","è±ªæ”¾ç£Šè½","å¤©ä¸‹ç„¡åŒ","åˆ®ç›®ç›¸å¾…","ä¸€è¦–åŒä»",
      "ç©ºç†ç©ºè«–","ç‰çŸ³æ··äº¤","ç²‰éª¨ç •èº«","ä¹æ­»ä¸€ç”Ÿ","æƒ…çŠ¶é…Œé‡","æè‘‰æœ«ç¯€","åŒåºŠç•°å¤¢","è»½æŒ™å¦„å‹•","çµ‚æ—¥ä¸€èª ","ä½™è£•ç¶½ã€…"
    ]
  };

  function $id(id){ return document.getElementById(id); }

  var levelSelect = $id('levelSelect');
  var startBtn = $id('startBtn');
  var pauseBtn = $id('pauseBtn');
  var restartBtn = $id('restartBtn');

  var qIndexEl = $id('qIndex');
  var lvlLabelEl = $id('lvlLabel');
  var timeLabel = $id('timeLabel');
  var timeHint = $id('timeHint');
  var feedback = $id('feedback');
  var statusLabel = $id('statusLabel');

  var cells = [$id('c0'),$id('c1'),$id('c2'),$id('c3')];
  var choiceBtns = [$id('ch0'),$id('ch1'),$id('ch2'),$id('ch3')];

  var progressEl = $id('progress');
  var logLines = $id('logLines');

  var overlay = $id('overlay');
  var avgLabel = $id('avgLabel');
  var scoreLabel = $id('scoreLabel');
  var praiseLabel = $id('praiseLabel');
  var detailLabel = $id('detailLabel');
  var playAgainBtn = $id('playAgainBtn');
  var closeOverlayBtn = $id('closeOverlayBtn');

  var level = 1;
  var gameActive = false;
  var paused = false;

  var questions = [];
  var qIdx = 0;
  var blankPos = 3;
  var correctChar = "";
  var results = [];

  var qStart = 0;
  var pauseStart = 0;
  var pausedAccum = 0;
  var rafId = 0;

  function fmtSec(ms){ return (ms/1000).toFixed(3) + "s"; }

  function shuffle(arr){
    var a = arr.slice();
    for(var i=a.length-1;i>0;i--){
      var j = Math.floor(Math.random()*(i+1));
      var t=a[i]; a[i]=a[j]; a[j]=t;
    }
    return a;
  }

  function buildKanjiPool(lv){
    var set = {};
    var src = idiomsByLevel[lv] || [];
    for(var i=0;i<src.length;i++){
      var s = src[i];
      // ã‚µãƒ­ã‚²ãƒ¼ãƒˆå¯¾ç­–ï¼šArray.from ã‚’ä½¿ã‚ãšã€for..ofã‚‚ä½¿ã‚ãšã€ç°¡æ˜“ï¼ˆå››å­—ç†Ÿèªãªã®ã§åŸºæœ¬1æ–‡å­—ï¼1ã‚³ãƒ¼ãƒ‰å˜ä½ã§OKï¼‰
      for(var k=0;k<s.length;k++){
        set[s.charAt(k)] = true;
      }
    }
    delete set["â–¡"];
    var out = [];
    for(var key in set){ if(set.hasOwnProperty(key)) out.push(key); }
    return out;
  }

  function pick10(lv){
    var src = idiomsByLevel[lv] || [];
    if(!src.length) return [];
    var bag = shuffle(src);
    var out = [];
    while(out.length < 10){
      if(!bag.length) bag = shuffle(src);
      out.push(bag.pop());
    }
    return out;
  }

  function makeChoices(lv, correct){
    var pool = buildKanjiPool(lv);
    var set = [correct];
    while(set.length < 4){
      var pick = pool[Math.floor(Math.random()*pool.length)];
      if(pick && pick !== correct && set.indexOf(pick) === -1) set.push(pick);
    }
    return shuffle(set);
  }

  function setChoicesEnabled(on){
    for(var i=0;i<choiceBtns.length;i++){
      choiceBtns[i].disabled = !on;
    }
  }

  function renderProgress(){
    progressEl.innerHTML = "";
    for(var i=0;i<10;i++){
      var d = document.createElement('div');
      d.className = "dot";
      d.textContent = String(i+1);
      if(i === qIdx && gameActive) d.className += " now";
      if(results[i]){
        d.className = "dot";
        if(results[i].correct) d.className += " done";
        else d.className += " bad";
      }
      progressEl.appendChild(d);
    }
  }

  function pushLog(text){
    var line = document.createElement('div');
    line.className = "line";
    line.textContent = text;
    logLines.insertBefore(line, logLines.firstChild);
    while(logLines.children.length > 10){
      logLines.removeChild(logLines.lastChild);
    }
  }

  function stopRAF(){
    if(rafId){ cancelAnimationFrame(rafId); rafId = 0; }
  }
  function updateTimer(){
    if(!gameActive){ timeLabel.textContent = "0.000s"; return; }
    var now = performance.now();
    var elapsed = now - qStart - pausedAccum;
    if(paused) elapsed = pauseStart - qStart - pausedAccum;
    if(elapsed < 0) elapsed = 0;
    timeLabel.textContent = fmtSec(elapsed);
    rafId = requestAnimationFrame(updateTimer);
  }

  function setIdiomCells(idiom){
    // 4æ–‡å­—å‰æ
    for(var i=0;i<4;i++){
      if(i === blankPos){
        cells[i].textContent = "â–¡";
        if(cells[i].className.indexOf("blank") === -1) cells[i].className += " blank";
      }else{
        cells[i].textContent = idiom.charAt(i);
        cells[i].className = cells[i].className.replace(/\bblank\b/g,"").trim();
      }
    }
  }

  function startQuestion(){
    feedback.textContent = "â€”";
    feedback.style.color = "var(--muted)";

    var idiom = questions[qIdx];
    blankPos = Math.floor(Math.random()*4);
    correctChar = idiom.charAt(blankPos);

    setIdiomCells(idiom);

    var choices = makeChoices(level, correctChar);
    for(var i=0;i<choiceBtns.length;i++){
      var btn = choiceBtns[i];
      btn.textContent = choices[i];
      btn.className = btn.className.replace(/\bgood\b|\bbad\b/g,"").trim() || "choice";
      btn.disabled = false;
    }

    paused = false;
    pauseBtn.textContent = "â¸ ä¸€æ™‚åœæ­¢";
    pausedAccum = 0;
    qStart = performance.now();
    timeHint.textContent = "è¨ˆæ¸¬ä¸­ï¼ˆå›ç­”ã™ã‚‹ã¨æ¬¡ã®å•é¡Œã¸ï¼‰";
    stopRAF(); updateTimer();

    qIndexEl.textContent = String(qIdx+1);
    lvlLabelEl.textContent = String(level);
    statusLabel.textContent = "å‡ºé¡Œä¸­";
    renderProgress();
  }

  function praiseByAvgSeconds(avgSec){
    if(avgSec <= 2.0) return "æ¼¢å­—ã®ç¥ã‹ã‚ˆï¼";
    if(avgSec <= 4.0) return "æ¼¢å­—åšå£«ã£ã¦å‘¼ã°ã‚Œãªã„ï¼Ÿ";
    if(avgSec <= 6.0) return "èª­æ›¸å¥½ããã†";
    if(avgSec <= 8.0) return "çœ ã‹ã£ãŸã ã‘ãƒ»ãƒ»ãƒ»ã ã‚ˆã­ï¼Ÿ";
    return "çœ ã‹ã£ãŸã ã‘ãƒ»ãƒ»ãƒ»ã ã‚ˆã­ï¼Ÿ";
  }

  function finishGame(){
    gameActive = false;
    setChoicesEnabled(false);
    pauseBtn.disabled = true;
    restartBtn.disabled = false;
    startBtn.disabled = false;
    levelSelect.disabled = false;
    stopRAF();
    statusLabel.textContent = "å®Œäº†";

    var total = 0;
    for(var i=0;i<results.length;i++){
      var r = results[i];
      if(r && typeof r.timeMs === "number") total += r.timeMs;
    }
    var avg = total / 10;
    var avgSec = avg / 1000;

    var correctCount = 0;
    for(var j=0;j<results.length;j++){
      if(results[j] && results[j].correct) correctCount++;
    }

    avgLabel.textContent = fmtSec(avg);
    scoreLabel.textContent = String(correctCount);
    praiseLabel.textContent = praiseByAvgSeconds(avgSec);

    var lines = [];
    var posName = ["1æ–‡å­—ç›®","2æ–‡å­—ç›®","3æ–‡å­—ç›®","4æ–‡å­—ç›®"];
    for(var k=0;k<results.length;k++){
      var rr = results[k];
      var mark = rr.correct ? "â—‹" : "Ã—";
      lines.push(
        (k+1) + ". " + rr.idiom +
        "ï¼ˆç©ºç™½:" + posName[rr.blankPos] + "ï¼‰ " +
        "å›ç­”:" + rr.answer + " " + mark + "  " + fmtSec(rr.timeMs)
      );
    }
    detailLabel.textContent = "ï¼ˆãƒ¬ãƒ™ãƒ«ï¼šLv." + level + "ï¼‰\n\n" + lines.join("\n");

    overlay.style.display = "flex";
  }

  function answer(choiceChar){
    if(!gameActive || paused) return;

    var now = performance.now();
    var elapsed = now - qStart - pausedAccum;

    var idiom = questions[qIdx];
    var ok = (choiceChar === correctChar);

    for(var i=0;i<choiceBtns.length;i++){
      var btn = choiceBtns[i];
      btn.disabled = true;
      var t = btn.textContent;
      btn.className = "choice";
      if(t === correctChar) btn.className += " good";
      if(t === choiceChar && !ok) btn.className += " bad";
    }

    feedback.textContent = ok ? "æ­£è§£ï¼" : ("ä¸æ­£è§£â€¦ï¼ˆæ­£è§£ï¼š" + correctChar + "ï¼‰");
    feedback.style.color = ok ? "var(--good)" : "var(--bad)";

    results[qIdx] = { idiom: idiom, blankPos: blankPos, answer: choiceChar, correct: ok, timeMs: Math.max(0, elapsed) };
    renderProgress();
    pushLog((qIdx+1) + "/10  " + (ok ? "â—‹" : "Ã—") + "  " + idiom + "  " + fmtSec(elapsed));

    stopRAF();
    setTimeout(function(){
      qIdx++;
      if(qIdx >= 10) finishGame();
      else startQuestion();
    }, 520);
  }

  function startGame(){
    level = parseInt(levelSelect.value, 10);
    if(!level || level < 1) level = 1;
    lvlLabelEl.textContent = String(level);

    questions = pick10(level);
    results = new Array(10);
    for(var i=0;i<10;i++) results[i] = null;
    qIdx = 0;

    gameActive = true;
    paused = false;
    overlay.style.display = "none";

    startBtn.disabled = true;
    restartBtn.disabled = false;
    pauseBtn.disabled = false;
    levelSelect.disabled = true;

    statusLabel.textContent = "é–‹å§‹";
    logLines.innerHTML = "";
    renderProgress();
    startQuestion();
  }

  function restartGame(){
    if(!levelSelect.disabled){
      level = parseInt(levelSelect.value, 10);
      if(!level || level < 1) level = 1;
    }
    levelSelect.value = String(level);
    startGame();
  }

  function togglePause(){
    if(!gameActive) return;
    if(!paused){
      paused = true;
      pauseStart = performance.now();
      pauseBtn.textContent = "â–¶ å†é–‹";
      timeHint.textContent = "ä¸€æ™‚åœæ­¢ä¸­ï¼ˆå†é–‹ã§ã‚«ã‚¦ãƒ³ãƒˆå†é–‹ï¼‰";
      statusLabel.textContent = "ä¸€æ™‚åœæ­¢";
      renderProgress();
    }else{
      var now = performance.now();
      pausedAccum += (now - pauseStart);
      paused = false;
      pauseBtn.textContent = "â¸ ä¸€æ™‚åœæ­¢";
      timeHint.textContent = "è¨ˆæ¸¬ä¸­ï¼ˆå›ç­”ã™ã‚‹ã¨æ¬¡ã®å•é¡Œã¸ï¼‰";
      statusLabel.textContent = "å‡ºé¡Œä¸­";
      renderProgress();
    }
  }

  // iPhoneã®ã‚¿ãƒƒãƒ—å–ã‚Šã“ã¼ã—å¯¾ç­–ï¼ˆclick + touchendã€é‡è¤‡ã‚¬ãƒ¼ãƒ‰ï¼‰
  function bindTap(el, fn){
    var lock = false;
    el.addEventListener("click", function(e){ fn(e); }, false);
    el.addEventListener("touchend", function(e){
      if(lock) return;
      lock = true;
      fn(e);
      setTimeout(function(){ lock = false; }, 250);
    }, {passive:true});
  }

  levelSelect.addEventListener('change', function(){ lvlLabelEl.textContent = String(levelSelect.value); }, {passive:true});
  bindTap(startBtn, startGame);
  bindTap(restartBtn, restartGame);
  bindTap(pauseBtn, togglePause);

  for(var i=0;i<choiceBtns.length;i++){
    (function(btn){
      bindTap(btn, function(){ answer(btn.textContent); });
    })(choiceBtns[i]);
  }

  bindTap(playAgainBtn, function(){
    overlay.style.display = "none";
    levelSelect.value = String(level);
    startGame();
  });
  bindTap(closeOverlayBtn, function(){ overlay.style.display = "none"; });

  renderProgress();
  setChoicesEnabled(false);
  pauseBtn.disabled = true;
  restartBtn.disabled = true;

  // æœ€å¾Œã«ã‚‚ã†ä¸€å›ãƒ•ã‚£ãƒƒãƒˆï¼ˆiOSã§åˆæœŸå€¤ã‚ºãƒ¬å¯¾ç­–ï¼‰
  setTimeout(fitStageRetry, 0);
})();
</script>
</body>
</html>